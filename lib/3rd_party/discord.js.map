{"version":3,"file":"discord.js","sourceRoot":"","sources":["../../src/3rd_party/discord.ts"],"names":[],"mappings":";;AAgCA,8CAeC;AA/CD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA+BG;AACH,SAAgB,iBAAiB,CAAE,GAAQ;;IACvC,MAAM,aAAa,GAAG,CAAA,MAAA,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,QAAQ,0CAAE,QAAQ,KAAI,WAAW,CAAC;IAEhE,MAAM,sBAAsB,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACvD,MAAM,SAAS,GAAG,CACd,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,mBAAmB,CAAC,IAAI,gCAAgC;QAC/E,CAAC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAK,oCAAoC;QAClF,sBAAsB,CAAC,MAAM,GAAG,CAAC,CACpC;QACG,CAAC,CAAC,IAAI,sBAAsB,CAAC,CAAC,CAAC,EAAE;QACjC,CAAC,CAAC,EAAE,CAAC;IAET,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QACvC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,KAAK,aAAa,GAAG,SAAS,GAAG,GAAG,CAAC,QAAQ,GAAG,GAAG,CAAC,MAAM,EAAE;QAC7E,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,KAAK,aAAa,mBAAmB,SAAS,GAAG,GAAG,CAAC,QAAQ,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;AACtG,CAAC","sourcesContent":["/**\r\n * Discord Embedded App SDK\r\n * https://github.com/colyseus/colyseus/issues/707\r\n *\r\n * All URLs must go through the local proxy from\r\n * https://<app_id>.discordsays.com/.proxy/<mapped_url>/...\r\n *\r\n * URL Mapping Examples:\r\n *\r\n * 1. Using Colyseus Cloud:\r\n *   - /colyseus/{subdomain} -> {subdomain}.colyseus.cloud\r\n *\r\n *   Example:\r\n *     const client = new Client(\"https://xxxx.colyseus.cloud\");\r\n *\r\n * -------------------------------------------------------------\r\n *\r\n * 2. Using `cloudflared` tunnel:\r\n *   - /colyseus/ -> <your-cloudflared-url>.trycloudflare.com\r\n *\r\n *   Example:\r\n *     const client = new Client(\"https://<your-cloudflared-url>.trycloudflare.com\");\r\n *\r\n * -------------------------------------------------------------\r\n *\r\n * 3. Providing a manual /.proxy/your-mapping:\r\n *   - /your-mapping/ -> your-endpoint.com\r\n *\r\n *   Example:\r\n *     const client = new Client(\"/.proxy/your-mapping\");\r\n *\r\n */\r\nexport function discordURLBuilder (url: URL): string {\r\n    const localHostname = window?.location?.hostname || \"localhost\";\r\n\r\n    const remoteHostnameSplitted = url.hostname.split('.');\r\n    const subdomain = (\r\n        !url.hostname.includes(\"trycloudflare.com\") && // ignore cloudflared subdomains\r\n        !url.hostname.includes(\"discordsays.com\") &&  // ignore discordsays.com subdomains\r\n        remoteHostnameSplitted.length > 2\r\n    )\r\n        ? `/${remoteHostnameSplitted[0]}`\r\n        : '';\r\n\r\n    return (url.pathname.startsWith(\"/.proxy\"))\r\n        ? `${url.protocol}//${localHostname}${subdomain}${url.pathname}${url.search}`\r\n        : `${url.protocol}//${localHostname}/.proxy/colyseus${subdomain}${url.pathname}${url.search}`;\r\n}\r\n"]}